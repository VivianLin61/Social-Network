(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{167:function(e,t,n){},192:function(e,t,n){},193:function(e,t,n){"use strict";n.r(t);var a,s,c,r,i,o,d=n(49),l=n.n(d),j=n(1),u=n(55),b=n(23),m=n(217),O=(n(166),n(167),n(11)),h=n(220),p=n(28),x=n(222),f=n(219),g=n(53),v=n.n(g),y=n(78),I=function(e){return function(){var t=Object(y.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.setItem("jwtToken",e.token),localStorage.setItem("user",JSON.stringify(e)),n({type:"LOGIN",payload:{email:e.email,id:e.id,profileImage:e.profileImage,token:e.token,username:e.username}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(e){return localStorage.setItem("user",JSON.stringify(e)),function(){var t=Object(y.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"UPDATE_USER",payload:{email:e.email,id:e.id,profileImage:e.profileImage,token:e.token,username:e.username}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},N=n(130),C=n(21),S=n(18),P=Object(S.a)(a||(a=Object(C.a)(["\n  {\n    getPosts {\n      id\n      body\n      createdAt\n      username\n      likeCount\n      likes {\n        username\n        userId\n      }\n      userId\n      commentCount\n      comments {\n        id\n        username\n        createdAt\n        body\n        userId\n      }\n    }\n  }\n"]))),k=Object(S.a)(s||(s=Object(C.a)(["\n  query GetNotifications($userId: String!) {\n    getNotifications(userId: $userId) {\n      id\n      message\n      postId\n      userId\n      createdAt\n      read\n    }\n  }\n"]))),$=Object(S.a)(c||(c=Object(C.a)(["\n  query GetUser($userId: ID!) {\n    getUser(userId: $userId) {\n      id\n      username\n      profileImage\n    }\n  }\n"]))),E=Object(S.a)(r||(r=Object(C.a)(["\n  mutation CreateNotification(\n    $postId: String!\n    $userId: String!\n    $message: String!\n  ) {\n    createNotification(postId: $postId, message: $message, userId: $userId) {\n      id\n      message\n      postId\n      userId\n      createdAt\n      read\n    }\n  }\n"]))),L=Object(S.a)(i||(i=Object(C.a)(["\n  mutation UpdateNotification($id: ID!) {\n    updateNotification(id: $id) {\n      id\n    }\n  }\n"]))),F=Object(S.a)(o||(o=Object(C.a)(["\n  mutation DeleteNotification($id: ID!) {\n    deleteNotification(id: $id)\n  }\n"]))),A=n(76),U=n(2);var D=function(e){function t(e){return Object(U.jsx)("button",{href:"#",onClick:e.handleDropdown,className:"menu-item",children:e.children})}return Object(U.jsxs)("div",{className:e.notification?"notification dropdown":"dropdown",children:[Object(U.jsx)("div",{className:"square"}),e.notification&&Object(U.jsx)(t,{handleDropdown:function(){e.notification&&e.updateNotification()},children:e.notification?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(A.a,{}),Object(U.jsx)("span",{children:"Mark Read"})]}):Object(U.jsx)(U.Fragment,{children:" "})}),Object(U.jsxs)(t,{handleDropdown:function(){e.notification?e.deleteNotification():(e.setShowDeleteModal(!0),e.setOpen(!1))},children:[Object(U.jsx)(A.c,{style:{color:"red"}}),Object(U.jsx)("span",{children:"Delete"})]})]})},B=n(54),_=n.n(B),M=n(66);var H=function(e){var t=e.notification,n=e.deactivateNotification,a=Object(j.useState)(!1),s=Object(O.a)(a,2),c=s[0],r=s[1],i=function(){r(!c)},o=Object(f.a)(F,{update:function(t){r(!1);var n=t.readQuery({query:k,variables:{userId:e.userId}});t.writeQuery({query:k,data:{getNotifications:n.getNotifications.filter((function(t){return t.id!==e.notification.id}))},variables:{userId:e.userId}})},variables:{id:t.id}}),d=Object(O.a)(o,1)[0],l=Object(f.a)(L,{update:function(t){r(!1);var n=t.readQuery({query:k,variables:{userId:e.userId}});t.writeQuery({query:k,data:{getNotifications:n.getNotifications.map((function(t){return t.id===e.notification.id?t.read=!0:t.read=!1}))},variables:{userId:e.userId}})},variables:{id:t.id}}),b=Object(O.a)(l,1)[0];return Object(U.jsx)("div",{className:"notificationCard",children:Object(U.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[Object(U.jsxs)(u.b,{onClick:function(){n(t.id)},to:"/posts/".concat(t.postId),children:[Object(U.jsx)("div",{children:t.message}),Object(U.jsx)("span",{children:_()(t.createdAt).fromNow(!0)+" ago"})]}),Object(U.jsx)("div",{onClick:i,className:c?"notificationMenu hoverMenu":"notificationMenu",children:Object(U.jsx)(M.a,{onClick:i})}),c&&Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(D,{deleteNotification:d,updateNotification:function(){b()},notification:"notification",setOpen:r})}),!t.read&&Object(U.jsx)("div",{className:"activeNoitification"})]})})};var T,q=function(){var e=Object(j.useState)(null),t=Object(O.a)(e,2),n=t[0],a=t[1],s=Object(j.useState)(!1),c=Object(O.a)(s,2),r=c[0],i=c[1],o=Object(j.useState)(!1),d=Object(O.a)(o,2),l=d[0],b=d[1],m=Object(j.useRef)(),g=function(){return i(!1)},I=function(){return i(!0)},w=0,C=null,S=Object(p.b)(),P=Object(p.c)((function(e){return e.auth.user})),$=Object(x.a)(k,{variables:{userId:n?n.id:""}}),E=$.data,F=$.refetch;Object(j.useEffect)((function(){var e=document.querySelectorAll(".notificationModal")[0];e&&r?document.querySelectorAll(".notificationModal")[0].classList.add("display"):e&&!r&&e.classList.remove("display")}),[r]),Object(j.useEffect)((function(){return document.addEventListener("mousedown",A),function(){document.removeEventListener("mousedown",A)}})),Object(j.useEffect)((function(){0===w&&b(!1)}),[w]);var A=function(e){m.current&&m.current.contains(e.target)||g()};if(E){C=E.getNotifications;var D=E.getNotifications.filter((function(e){return!1===e.read}));w=D.length}var B=function(e){I(),b(!0)};Object(j.useEffect)((function(){a(P||null)}),[P]);var _=Object(f.a)(L,{onCompleted:function(){F()}}),M=Object(O.a)(_,1)[0],T=function(e){M({variables:{id:e}}),g()};return null!=n?Object(U.jsx)(U.Fragment,{children:Object(U.jsxs)(h.a,{defaultActiveKey:"/",as:"ul",className:"loggedInNavBar",children:[Object(U.jsx)(h.a.Item,{as:"li",children:Object(U.jsx)(h.a.Link,{href:"/",children:"Social Network"})}),Object(U.jsxs)("div",{className:"rightMenu",children:[Object(U.jsx)(h.a.Item,{children:Object(U.jsxs)("div",{className:"notificationIcon",children:[Object(U.jsx)("button",{onClick:function(){I()},children:Object(U.jsx)(N.a,{})}),C&&w>0&&Object(U.jsx)("span",{className:"notificationCount",children:w})]})}),Object(U.jsx)(h.a.Item,{as:"li",children:Object(U.jsx)(h.a.Link,{href:"/profile/".concat(n.id),children:n.username})}),Object(U.jsx)(h.a.Item,{as:"li",onClick:function(){S((localStorage.clear(),function(){var e=Object(y.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},children:Object(U.jsx)(u.b,{className:"nav-link",to:"/login",children:"Logout"})})]}),Object(U.jsxs)("div",{ref:m,className:"notificationModal",children:[Object(U.jsx)("h1",{children:"Notifications"}),C&&C.map((function(e,t){return Object(U.jsx)(H,{deactivateNotification:T,notificationMenu:B,menu:l,notification:e,userId:n?n.id:""},t)}))]})]})}):Object(U.jsxs)(h.a,{defaultActiveKey:"/",as:"ul",className:"loggedInNavBar",children:[Object(U.jsx)(h.a.Item,{as:"li",children:Object(U.jsx)(h.a.Link,{href:"/",children:"Social Network"})}),Object(U.jsxs)("div",{className:"rightMenu",children:[Object(U.jsx)(h.a.Item,{name:"login",as:"li",children:Object(U.jsx)(h.a.Link,{href:"/login",children:"Login"})}),Object(U.jsx)(h.a.Item,{as:"li",name:"register",children:Object(U.jsx)(h.a.Link,{href:"/register",children:"Register"})})]})]})},G=n(99);var R=Object(S.a)(T||(T=Object(C.a)(["\n  mutation likePost($postId: ID!) {\n    likePost(postId: $postId) {\n      id\n      likes {\n        id\n        username\n        userId\n      }\n      likeCount\n    }\n  }\n"]))),Q=function(e){var t=e.user,n=e.post,a=n.userId,s=n.id,c=n.likeCount,r=n.likes,i=Object(j.useState)(!1),o=Object(O.a)(i,2),d=o[0],l=o[1];Object(j.useEffect)((function(){t&&r.find((function(e){return e.userId===t.id}))?l(!0):l(!1)}),[t,r]);var u=Object(f.a)(R,{variables:{postId:s},onCompleted:function(){l(!d),d||a!==t.id&&h()}}),b=Object(O.a)(u,1)[0],m=Object(f.a)(E,{variables:{message:t?"".concat(t.username," liked your post"):"",postId:s,userId:a||""},onError:function(e){console.log(e)}}),h=Object(O.a)(m,1)[0],p=t?d?Object(U.jsx)("button",{className:"likedButton",children:Object(U.jsx)(G.a,{onClick:b,style:{fontSize:"20px"}})}):Object(U.jsx)("button",{className:"likeButton",children:Object(U.jsx)(G.b,{onClick:b,style:{pointerEvents:"auto",fontSize:"20px"}})}):Object(U.jsx)(G.b,{className:"likeButton",style:{fontSize:"20px"}});return Object(U.jsxs)(U.Fragment,{children:[p," ",Object(U.jsx)("span",{className:"commentAndLikeCount",children:c})]})},z=n(213),J=n(132),W=n(16),K=n(218),V=n(212);var X,Y,Z=function(e){return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(K.a,{className:"popUp-modal",show:e.show,onHide:e.handleClose,children:Object(U.jsx)(K.a.Header,{children:Object(U.jsx)(K.a.Title,{children:e.title})})})})};var ee=Object(S.a)(X||(X=Object(C.a)(["\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId)\n  }\n"]))),te=Object(S.a)(Y||(Y=Object(C.a)(["\n  mutation deleteComment($postId: ID!, $commentId: ID!) {\n    deleteComment(postId: $postId, commentId: $commentId) {\n      id\n      comments {\n        id\n        username\n        createdAt\n        body\n      }\n      commentCount\n    }\n  }\n"]))),ne=function(e){var t=e.comment_id?te:ee,n=e.comment_id?"Delete Comment":e.post_id?"Delete Post":"Delete Notification",a=Object(j.useState)(!1),s=Object(O.a)(a,2),c=s[0],r=s[1],i=Object(f.a)(t,{update:function(t){if(e.onHide(),e.post_id){var n=t.readQuery({query:P});t.writeQuery({query:P,data:{getPosts:n.getPosts.filter((function(t){return t.id!==e.post_id}))}}),e.callback&&e.callback()}},variables:{postId:e.post_id,commentId:e.comment_id}}),o=Object(O.a)(i,1)[0];return Object(U.jsxs)(K.a,Object(W.a)(Object(W.a)({},e),{},{size:"sm","aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"deleteModal",children:[Object(U.jsxs)(K.a.Body,{className:"deletePostBody",children:[Object(U.jsx)("h4",{children:n}),Object(U.jsx)("p",{children:"This cannot be undone and will be removed from your profile."})]}),Object(U.jsxs)(K.a.Footer,{children:[Object(U.jsx)(V.a,{onClick:e.onHide,children:"Close"}),Object(U.jsx)(V.a,{onClick:function(){r(!0),o()},children:"Delete"})]}),Object(U.jsx)(Z,{title:"Deleting...",show:c,handleClosePopup:function(){r(!1)}})]}))};var ae,se=function(e){var t=e.post,n=e.userInfo,a=t.body,s=t.createdAt,c=t.id,r=t.userId,i=t.likeCount,o=t.commentCount,d=t.likes,l={},b=Object(j.useState)(!1),m=Object(O.a)(b,2),h=m[0],p=m[1],f=Object(j.useState)(!1),g=Object(O.a)(f,2),v=g[0],y=g[1],I=Object(x.a)($,{variables:{userId:r}}).data;return I&&(l=I.getUser),Object(U.jsx)(U.Fragment,{children:Object(U.jsxs)("div",{className:"postCardContainer",children:[Object(U.jsxs)(z.a,{children:[Object(U.jsx)(J.a,{xs:2,children:Object(U.jsx)("img",{src:l.profileImage,alt:""})}),Object(U.jsx)(J.a,{xs:10,children:Object(U.jsxs)(z.a,{xs:2,className:"justify-content-md-center postBody",children:[h&&Object(U.jsx)(D,{setShowDeleteModal:y,setOpen:p}),Object(U.jsx)(J.a,{xs:12,children:Object(U.jsx)(z.a,{children:Object(U.jsxs)("div",{children:[Object(U.jsx)("span",{children:[l.username]}),Object(U.jsx)("span",{children:_()(s).fromNow(!0)+" ago"}),n&&n.id===r?Object(U.jsx)(M.a,{onClick:function(){return p(!h)}}):null]})})}),Object(U.jsx)(J.a,{style:{height:"70px"},xs:12,children:a}),Object(U.jsxs)(J.a,{className:"align-text-bottom",xs:12,children:[Object(U.jsx)(u.b,{to:"/posts/".concat(c),children:Object(U.jsx)(A.b,{style:{fontSize:"22px"}})}),Object(U.jsx)("span",{className:"commentAndLikeCount",children:o}),Object(U.jsx)(Q,{user:n,post:{id:c,likes:d,userId:r,likeCount:i}})]})]})})]}),Object(U.jsx)(ne,{post_id:c,show:v,onHide:function(){return y(!1)}})]})})},ce=n(214),re=n(134),ie=n(144),oe=n(221),de=n(133),le=n(94),je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(j.useState)(t),a=Object(O.a)(n,2),s=a[0],c=a[1],r=function(e){c(Object(W.a)(Object(W.a)({},s),{},Object(le.a)({},e.target.name,e.target.value)))},i=function(t){t.preventDefault(),e()},o=function(){c({})};return{onChange:r,onSubmit:i,resetValues:o,values:s}};var ue=Object(S.a)(ae||(ae=Object(C.a)(["\n  mutation createPost($body: String!) {\n    createPost(body: $body) {\n      id\n      body\n      createdAt\n      username\n      userId\n      likes {\n        id\n        username\n        createdAt\n      }\n      likeCount\n      comments {\n        id\n        body\n        username\n        createdAt\n      }\n      commentCount\n    }\n  }\n"]))),be=function(e){var t=Object(j.useRef)(),n=je((function(){}),{body:""}),a=n.values,s=n.onChange,c=n.onSubmit,r=Object(f.a)(ue,{variables:a,update:function(e,t){var n=e.readQuery({query:P});e.writeQuery({query:P,data:{getPosts:[t.data.createPost].concat(Object(ie.a)(n.getPosts))}}),a.body=""}}),i=Object(O.a)(r,2),o=i[0],d=i[1].error,l=function(t){e.onHide(),c(t),o()};return Object(U.jsxs)(K.a,Object(W.a)(Object(W.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"createPostModal",onEntered:function(){return t.current.focus()},children:[Object(U.jsxs)(K.a.Header,{children:[Object(U.jsx)(K.a.Title,{id:"contained-modal-title-vcenter",children:Object(U.jsx)("h1",{children:"Create Post"})}),Object(U.jsx)("button",{onClick:e.onHide,className:"closeCreateFormModal",children:Object(U.jsx)(de.a,{})})]}),Object(U.jsx)(K.a.Body,{children:Object(U.jsx)(oe.a.Group,{controlId:"exampleForm.ControlTextarea1",children:Object(U.jsx)(oe.a.Control,{className:"createPostFormModal",placeholder:"What's on your mind, ".concat(e.username,"?"),onChange:s,name:"body",value:a.body,as:"textarea",rows:3,ref:t,error:!!d||void 0})})}),Object(U.jsx)(K.a.Footer,{children:""!==a.body?Object(U.jsx)(V.a,{className:"postButton",onClick:l,children:"Post"}):Object(U.jsx)(V.a,{className:"postButton",onClick:l,style:{backgroundColor:"gray",pointerEvents:"none"},children:"Post"})})]}))};var me,Oe=function(){var e=Object(j.useState)(null),t=Object(O.a)(e,2),n=t[0],a=t[1],s=Object(p.c)((function(e){return e.auth.user})),c=Object(x.a)(P),r=c.loading,i=c.data,o=(i=void 0===i?{}:i).getPosts,d=Object(j.useState)(!1),l=Object(O.a)(d,2),u=l[0],b=l[1];return Object(j.useEffect)((function(){a(s||null)}),[s]),Object(U.jsxs)(U.Fragment,{children:[n&&Object(U.jsx)("div",{className:"postsList",children:Object(U.jsx)("div",{className:"postCardContainer",children:Object(U.jsx)(J.a,{xs:12,children:Object(U.jsxs)(z.a,{xs:2,className:"justify-content-md-center createPostBody",children:[Object(U.jsxs)(J.a,{className:"h-20",xs:12,children:[Object(U.jsx)("div",{children:"Post Something"}),Object(U.jsx)("hr",{})]}),Object(U.jsx)(J.a,{className:"h-80",xs:12,children:Object(U.jsxs)(z.a,{children:[Object(U.jsx)(J.a,{xs:1,children:Object(U.jsx)("img",{style:{marginLeft:"5px",marginTop:"0px",width:"50px"},src:n.profileImage,alt:""})}),Object(U.jsx)(J.a,{xs:11,children:Object(U.jsx)(ce.a,{className:"mb-3 createPostForm",children:Object(U.jsx)(re.a,{placeholder:"What's on your mind, ".concat(n.username,"?"),"aria-label":"createPostForm","aria-describedby":"basic-addon1",onClick:function(){return b(!0)},style:{cursor:"pointer"},readOnly:!0})})})]})})]})})})}),r?Object(U.jsx)("div",{className:"loader",children:"Loading..."}):Object(U.jsx)("div",{className:"postsList",children:Object(U.jsx)(U.Fragment,{children:o&&o.map((function(e,t){return Object(U.jsx)(se,{post:e,userInfo:n},t)}))})}),Object(U.jsx)(be,{username:n?n.username:void 0,show:u,onHide:function(){return b(!1)}})]})};var he,pe=function(e){var t=Object(j.useState)({}),n=Object(O.a)(t,2),a=n[0],s=n[1],c=Object(p.b)(),r=je((function(){b()}),{username:"",email:""}),i=r.onChange,o=r.onSubmit,d=r.values,l=Object(f.a)(xe,{update:function(t,n){var a=n.data.login;c(I(a)),e.history.push("/")},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:d}),u=Object(O.a)(l,2),b=u[0],m=u[1].loading;return Object(U.jsx)("div",{className:"container",children:m?Object(U.jsx)("div",{className:"loader",children:"Loading"}):Object(U.jsxs)("div",{className:"form-container",children:[Object(U.jsxs)(oe.a,{onSubmit:o,children:[Object(U.jsx)("h1",{children:"Login"}),Object(U.jsxs)(oe.a.Group,{controlId:"formBasicEmail",children:[Object(U.jsx)(oe.a.Label,{children:"Email"}),Object(U.jsx)(oe.a.Control,{type:"email",name:"email",placeholder:"Enter email",value:d.email,error:!!a.email||void 0,onChange:i})]}),Object(U.jsxs)(oe.a.Group,{controlId:"formBasicPassword",children:[Object(U.jsx)(oe.a.Label,{children:"Password"}),Object(U.jsx)(oe.a.Control,{type:"password",name:"password",placeholder:"Password",value:null==d.password?"":d.password,error:!!a.password||void 0,onChange:i})]}),Object(U.jsx)(V.a,{className:"formSubmit",variant:"primary",type:"submit",children:"Login"})]}),Object.keys(a).length>0&&Object(U.jsx)("div",{className:"ui error message",children:Object(U.jsx)("ul",{className:"list",children:Object.values(a).map((function(e){return Object(U.jsx)("li",{children:e},e)}))})})]})})},xe=Object(S.a)(me||(me=Object(C.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      id\n      email\n      username\n      createdAt\n      profileImage\n      token\n    }\n  }\n"])));var fe=Object(S.a)(he||(he=Object(C.a)(["\n  mutation register(\n    $username: String!\n    $email: String!\n    $password: String!\n    $confirmPassword: String!\n  ) {\n    register(\n      registerInput: {\n        username: $username\n        email: $email\n        password: $password\n        confirmPassword: $confirmPassword\n      }\n    ) {\n      id\n      email\n      username\n      createdAt\n      profileImage\n      token\n    }\n  }\n"]))),ge=function(e){var t=Object(j.useState)({}),n=Object(O.a)(t,2),a=n[0],s=n[1],c=Object(p.b)(),r=je((function(){b()}),{username:"",email:"",password:"",confirmPassword:""}),i=r.onChange,o=r.onSubmit,d=r.values,l=Object(f.a)(fe,{update:function(t,n){var a=n.data.register;c(I(a)),e.history.push("/")},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:d}),u=Object(O.a)(l,2),b=u[0],m=u[1].loading;return Object(U.jsxs)(U.Fragment,{children:[" ",m?Object(U.jsx)("div",{className:"loader",children:"Loading..."}):Object(U.jsxs)("div",{style:{marginTop:"10px"},className:"form-container",children:[Object(U.jsxs)(oe.a,{onSubmit:o,children:[Object(U.jsx)("h1",{children:"Regsiter"}),Object(U.jsxs)(oe.a.Group,{children:[Object(U.jsx)(oe.a.Label,{children:"Username"}),Object(U.jsx)(oe.a.Control,{type:"username",name:"username",placeholder:"Enter Username",value:d.username,error:!!a.username||void 0,onChange:i})]}),Object(U.jsxs)(oe.a.Group,{children:[Object(U.jsx)(oe.a.Label,{children:"Email"}),Object(U.jsx)(oe.a.Control,{type:"email",name:"email",placeholder:"Enter Email",value:d.email,error:!!a.email||void 0,onChange:i})]}),Object(U.jsxs)(oe.a.Group,{children:[Object(U.jsx)(oe.a.Label,{children:"Password"}),Object(U.jsx)(oe.a.Control,{type:"password",name:"password",placeholder:"Password",value:d.password,error:!!a.password||void 0,onChange:i})]}),Object(U.jsxs)(oe.a.Group,{children:[Object(U.jsx)(oe.a.Label,{children:"Confirm Password"}),Object(U.jsx)(oe.a.Control,{type:"password",name:"confirmPassword",placeholder:"Confirm Password",value:d.confirmPassword,error:!!a.confirmPassword||void 0,onChange:i})]}),Object(U.jsx)(V.a,{className:"formSubmit",variant:"primary",type:"submit",children:"Register"})]}),Object.keys(a).length>0&&Object(U.jsx)("div",{className:"ui error message",children:Object(U.jsx)("ul",{className:"list",children:Object.values(a).map((function(e){return Object(U.jsx)("li",{children:e},e)}))})})]})]})};var ve,ye,Ie=function(e){var t=e.comment,n=e.user,a=e.postId,s=Object(j.useState)(!1),c=Object(O.a)(s,2),r=c[0],i=c[1],o=Object(j.useState)(!1),d=Object(O.a)(o,2),l=d[0],u=d[1];return Object(U.jsxs)(U.Fragment,{children:[" ",Object(U.jsxs)(z.a,{children:[Object(U.jsx)(J.a,{xs:1,children:Object(U.jsx)("img",{size:"small",src:t.image,float:"right",alt:"none"})}),Object(U.jsx)(J.a,{xs:11,children:Object(U.jsxs)(z.a,{className:"commentBody",children:[r&&Object(U.jsx)(D,{setShowDeleteModal:u,setOpen:i}),Object(U.jsxs)(J.a,{xs:12,children:[Object(U.jsx)("span",{children:t.username}),Object(U.jsx)("span",{children:_()(t.createdAt).fromNow(!0)+" ago"}),n&&n.id===t.userId?Object(U.jsx)(M.a,{className:"editModal",onClick:function(){return i(!r)}}):null]}),Object(U.jsx)(J.a,{xs:12,children:Object(U.jsx)("div",{children:t.body})})]})})]})," ",Object(U.jsx)(ne,{post_id:a,comment_id:t.id,show:l,onHide:function(){return u(!1)}})]})};var we=Object(S.a)(ve||(ve=Object(C.a)(["\n  mutation ($postId: String!, $body: String!, $commenterId: String!) {\n    createComment(postId: $postId, body: $body, commenterId: $commenterId) {\n      id\n      comments {\n        id\n        body\n        createdAt\n        username\n        image\n        userId\n      }\n      commentCount\n    }\n  }\n"]))),Ne=Object(S.a)(ye||(ye=Object(C.a)(["\n  query ($postId: ID!) {\n    getPost(postId: $postId) {\n      id\n      body\n      userId\n      createdAt\n      username\n      likeCount\n      likes {\n        username\n      }\n      commentCount\n      comments {\n        id\n        username\n        createdAt\n        body\n        image\n        userId\n      }\n    }\n  }\n"]))),Ce=function(e){var t=e.match.params.postId,n=Object(p.c)((function(e){return e.auth.user})),a=Object(j.useState)(null),s=Object(O.a)(a,2),c=s[0],r=s[1],i=Object(j.useState)(""),o=Object(O.a)(i,2),d=o[0],l=o[1],u=Object(j.useRef)(null),b=null,m=null;Object(j.useEffect)((function(){r(n||null)}),[n]);var h=Object(x.a)(Ne,{onError:function(e){console.log(e)},variables:{postId:t}}),g=h.data,v=h.error;v&&console.log(v),g&&(b=g.getPost);var y=Object(x.a)($,{variables:{userId:b?b.userId:""}}).data;y&&(m=y.getUser);var I=Object(f.a)(we,{update:function(){l(""),b.userId!==c.id&&C(),u.current.blur()},variables:{postId:t,body:d,commenterId:c?c.id:""}}),w=Object(O.a)(I,1)[0],N=Object(f.a)(E,{variables:{message:c?"".concat(c.username," commented on your post"):"",postId:t,userId:b?b.userId:""},onError:function(e){console.log(e)}}),C=Object(O.a)(N,1)[0];return Object(U.jsx)(U.Fragment,{children:b?Object(U.jsx)(U.Fragment,{children:Object(U.jsx)("div",{className:"singlePostContainer",children:Object(U.jsxs)(z.a,{children:[Object(U.jsx)(J.a,{xs:2,children:Object(U.jsx)("img",{src:m?m.profileImage:"",alt:""})}),Object(U.jsx)(J.a,{xs:10,children:Object(U.jsxs)(z.a,{xs:2,className:"justify-content-md-center postBody",children:[Object(U.jsx)(J.a,{xs:12,children:Object(U.jsx)(z.a,{children:Object(U.jsxs)("div",{children:[Object(U.jsx)("span",{children:b.username}),Object(U.jsx)("span",{children:_()(b.createdAt).fromNow(!0)+" ago"})]})})}),Object(U.jsx)(J.a,{style:{height:"70px"},xs:12,children:b.body}),Object(U.jsx)(J.a,{className:"align-text-bottom",xs:12})]})}),Object(U.jsx)(J.a,{xs:12,children:Object(U.jsxs)(z.a,{xs:2,className:"justify-content-md-center createPostBody",children:[Object(U.jsxs)(J.a,{className:"h-20",xs:12,children:[Object(U.jsx)("div",{children:"".concat(b.comments.length," comments")}),Object(U.jsx)("hr",{})]}),c?Object(U.jsx)(J.a,{className:"h-80",xs:12,children:Object(U.jsxs)(z.a,{children:[Object(U.jsx)(J.a,{xs:10,children:Object(U.jsx)(ce.a,{className:"mb-3 createPostForm",children:Object(U.jsx)(re.a,{placeholder:"What's on your mind, ".concat(c.username,"?"),"aria-label":"createPostForm","aria-describedby":"basic-addon1",onChange:function(e){return l(e.target.value)},value:d,ref:u})})}),Object(U.jsx)(J.a,{xs:2,children:Object(U.jsx)("div",{className:"submitComment",children:Object(U.jsx)(V.a,{onClick:w,children:"Submit"})})})]})}):null," "]})}),b.comments.map((function(e,n){return Object(U.jsx)("div",{className:"commentContainer",children:Object(U.jsx)(Ie,{user:c,comment:e,postId:t})},n)}))]})})}):Object(U.jsx)("div",{className:"loader",children:"Loading..."})})},Se=(n(177),n(135));var Pe,ke,$e=function(e){var t=e.imageHandler,n=e.profileImg;return"PHOTO"===e.name?Object(U.jsxs)(U.Fragment,{children:[" ",Object(U.jsxs)("div",{className:"update_photo",children:[Object(U.jsxs)("div",{className:"info",children:[Object(U.jsx)("div",{children:e.name}),Object(U.jsx)("div",{children:"Add a photo to your account"})]}),Object(U.jsxs)("div",{className:"img-holder",children:[Object(U.jsx)("input",{type:"file",accept:"image/*",name:"image-upload",id:"profile_input",onChange:t}),Object(U.jsx)("label",{className:"image-upload",htmlFor:"profile_input",children:Object(U.jsx)("img",{alt:"none",src:n})})]})," "]}),Object(U.jsx)("hr",{})]}):Object(U.jsxs)(U.Fragment,{children:[" ",Object(U.jsxs)("div",{onClick:e.handleUpdateInfo,className:"update_item",children:[Object(U.jsxs)("div",{className:"info",children:[Object(U.jsx)("div",{children:e.name}),Object(U.jsx)("div",{children:e.value})]}),Object(U.jsx)("div",{className:"update_icon",children:Object(U.jsx)(Se.a,{})})]}),Object(U.jsx)("hr",{})]})},Ee=function(e){var t,n=Object(j.useState)({email:!1,username:!1,confirmPassword:!1,password:!1,currentPassword:!1}),a=Object(O.a)(n,2),s=a[0],c=a[1];return Object(U.jsxs)(K.a,Object(W.a)(Object(W.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,className:"updateInfoModal",children:[Object(U.jsx)(K.a.Header,{children:Object(U.jsx)(K.a.Title,{id:"contained-modal-title-vcenter",children:"Change ".concat(e.type)})}),Object(U.jsx)(K.a.Body,{children:Object(U.jsxs)(oe.a,{onSubmit:e.onSubmit,children:["Email"===e.type&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(oe.a.Label,{children:"Current Email"}),Object(U.jsx)(oe.a.Control,{type:"text",placeholder:e.user.email,readOnly:!0,className:"disabledInput"}),Object(U.jsx)(oe.a.Control,{type:"text",name:"email",onChange:e.onChange,placeholder:"New Email"})]}),"Username"===e.type&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(oe.a.Label,{children:"Current Username"}),Object(U.jsx)(oe.a.Control,{type:"text",placeholder:e.user.username,readOnly:!0,className:"disabledInput"}),Object(U.jsx)(oe.a.Control,{type:"username",placeholder:"New Username",onChange:e.onChange,name:"username"})]}),"Password"===e.type&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(oe.a.Label,{children:"Current Password"}),Object(U.jsx)(oe.a.Control,{type:"password",name:"currentPassword",placeholder:"Current Password"}),Object(U.jsx)(oe.a.Control,{type:"password",name:"password",onChange:e.onChange,placeholder:"New password"}),Object(U.jsx)(oe.a.Control,{type:"password",name:"confirmPassword",onChange:e.onChange,placeholder:"Confirm new password"})]})," ",e.errors.confirmPassword?Object(U.jsxs)(U.Fragment,{children:[" ",Object(U.jsx)("div",{className:"modalError",children:"Passwords must match"})]}):Object(U.jsx)(U.Fragment,{children:" "}),e.errors.general?Object(U.jsx)(U.Fragment,{children:Object(U.jsx)("div",{className:"modalError",children:"Current password is incorrect"})}):Object(U.jsx)(U.Fragment,{children:" "}),"Username"===e.type&&s.username&&Object(U.jsx)("div",{className:"modalError",children:"Fields must not be empty"}),"Email"===e.type&&s.email&&Object(U.jsx)("div",{className:"modalError",children:"Email must not be empty"}),"Password"===e.type&&s.currentPassword&&Object(U.jsx)("div",{className:"modalError",children:"Current Password must not be empty"}),"Password"===e.type&&s.password&&Object(U.jsx)("div",{className:"modalError",children:"Password must not be empty"}),"Password"===e.type&&s.confirmPassword&&Object(U.jsx)("div",{className:"modalError",children:"Confirm Password must not be empty"}),Object(U.jsxs)("div",{className:"footer",children:[Object(U.jsx)(V.a,{className:e.showPopup&&"disableButton",onClick:e.onHide,children:"Cancel"}),Object(U.jsx)(V.a,{onClick:function(){"Email"===e.type&&""===document.getElementsByName("email")[0].value&&(c((function(e){return Object(W.a)(Object(W.a)({},e),{},{email:!0})})),t=!0),"Username"===e.type&&""===document.getElementsByName("username")[0].value&&(c((function(e){return Object(W.a)(Object(W.a)({},e),{},{username:!0})})),t=!0),"Password"===e.type&&""===document.getElementsByName("confirmPassword")[0].value&&(c((function(e){return Object(W.a)(Object(W.a)({},e),{},{confirmPassword:!0})})),t=!0),"Password"===e.type&&""===document.getElementsByName("currentPassword")[0].value&&(c((function(e){return Object(W.a)(Object(W.a)({},e),{},{currentPassword:!0})})),t=!0),"Password"===e.type&&""===document.getElementsByName("password")[0].value&&(c((function(e){return Object(W.a)(Object(W.a)({},e),{},{password:!0})})),t=!0),t||e.onShow(!0)},variant:"primary",type:"submit",children:"Submit"})]})]})})," ",Object(U.jsx)(Z,{title:"Updating...",show:e.popup,handleClose:e.handleClosePopup})]}))};var Le=Object(S.a)(Pe||(Pe=Object(C.a)(["\n  mutation AddProfileImage($_id: String!, $file: FileUpload!) {\n    addProfileImage(_id: $_id, file: $file) {\n      username\n      email\n      profileImage\n      id\n    }\n  }\n"]))),Fe=Object(S.a)(ke||(ke=Object(C.a)(["\n  mutation UpdateUser(\n    $_id: String!\n    $email: String\n    $password: String\n    $username: String\n    $currentPassword: String\n    $confirmPassword: String\n  ) {\n    updateUser(\n      _id: $_id\n      email: $email\n      password: $password\n      username: $username\n      currentPassword: $currentPassword\n      confirmPassword: $confirmPassword\n    ) {\n      username\n      email\n      profileImage\n      id\n    }\n  }\n"]))),Ae=function(){var e=Object(p.c)((function(e){return e.auth.user})),t=Object(j.useState)(!1),n=Object(O.a)(t,2),a=n[0],s=n[1],c=Object(j.useState)(""),r=Object(O.a)(c,2),i=r[0],o=r[1],d=Object(p.b)(),l=Object(j.useState)(!1),u=Object(O.a)(l,2),b=u[0],m=u[1],h=Object(j.useState)({}),x=Object(O.a)(h,2),g=x[0],v=x[1],y=Object(j.useState)(""),I=Object(O.a)(y,2),N=I[0],C=I[1],S=je((function(){(E.password&&E.confirmPassword&&E.currentPassword||E.username||E.email)&&z()})),P=S.onChange,k=S.resetValues,$=S.onSubmit,E=S.values,L=Object(j.useState)(""),F=Object(O.a)(L,2),A=F[0],D=F[1],B=Object(j.useState)(""),_=Object(O.a)(B,2),M=_[0],H=_[1],T=Object(j.useState)({}),q=Object(O.a)(T,2),G=q[0],R=q[1],Q=Object(f.a)(Fe,{update:function(e,t){var n=t.data.updateUser;m(!1),s(!1),H(n.email),D(n.username),d(w(n)),k()},onError:function(e){R(e.graphQLErrors[0].extensions.exception.errors),s(!1),k()},variables:Object(W.a)(Object(W.a)({},E),{},{_id:g?g.id:""})}),z=Object(O.a)(Q,1)[0];Object(j.useEffect)((function(){e&&(o(e.profileImage),D(e.username),H(e.email),v(e))}),[e]);var J=Object(f.a)(Le,{onCompleted:function(e){return d(w(e.addProfileImage))}}),K=Object(O.a)(J,1)[0];return Object(U.jsx)(U.Fragment,{children:g?Object(U.jsxs)("div",{className:"profile_container",children:[Object(U.jsx)("h4",{children:"Account Info"}),Object(U.jsx)($e,{profileImg:i,imageHandler:function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(){2===n.readyState&&o(n.result)},t&&(K({variables:{file:t,_id:g?g.id:""}}),n.readAsDataURL(e.target.files[0]))},name:"PHOTO"}),Object(U.jsx)($e,{value:A,handleUpdateInfo:function(e){m(!b),C("Username")},name:"USERNAME"}),Object(U.jsx)($e,{handleUpdateInfo:function(e){m(!b),C("Email")},value:M,name:"EMAIL"}),Object(U.jsx)($e,{value:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",handleUpdateInfo:function(e){m(!b),C("Password")},name:"PASSWORD"}),Object(U.jsx)(Ee,{show:b,onHide:function(){return m(!1)},type:N,user:g,onChange:P,onSubmit:$,values:E,errors:G,popup:!!a||void 0,onShow:s})]}):Object(U.jsx)(U.Fragment,{children:" "})})};var Ue=function(){var e=Object(p.b)(),t=Object(p.c)((function(e){return e.auth}));return Object(j.useEffect)((function(){null==t.user&&e(function(){var e=Object(y.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.getItem("jwtToken")&&(n=JSON.parse(localStorage.getItem("user")),t({type:"LOGIN",payload:n}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),Object(U.jsx)(u.a,{children:Object(U.jsxs)(m.a,{children:[Object(U.jsx)(q,{}),Object(U.jsx)(b.a,{exact:!0,path:"/",component:Oe}),Object(U.jsx)(b.a,{exact:!0,path:"/login",component:pe}),Object(U.jsx)(b.a,{exact:!0,path:"/register",component:ge}),Object(U.jsx)(b.a,{exact:!0,path:"/profile/:userId",component:Ae}),Object(U.jsx)(b.a,{exact:!0,path:"/posts/:postId",component:Ce})]})})},De=n(140),Be=n(143),_e=n(216),Me=n(145),He=n(215),Te=n.n(He),qe=n(68),Ge=n(137),Re={user:null},Qe=Object(qe.combineReducers)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(W.a)(Object(W.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(W.a)(Object(W.a)({},e),{},{user:null});case"UPDATE_USER":return Object(W.a)(Object(W.a)({},e),{},{user:t.payload});default:return e}}}),ze=n(138),Je=Te()({uri:"graphql"}),We=Object(Me.a)((function(){var e=localStorage.getItem("jwtToken");return{headers:{Authorization:e?"Bearer ".concat(e):""}}})),Ke=new De.a({link:We.concat(Je),cache:new Be.a}),Ve=Object(qe.createStore)(Qe,Object(Ge.composeWithDevTools)(Object(qe.applyMiddleware)(ze.a))),Xe=Object(U.jsx)(_e.a,{client:Ke,children:Object(U.jsx)(p.a,{store:Ve,children:Object(U.jsx)(Ue,{})})});n(192);l.a.render(Xe,document.getElementById("root"))}},[[193,1,2]]]);
//# sourceMappingURL=main.4b367ae9.chunk.js.map